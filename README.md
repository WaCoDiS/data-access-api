<!-- # OpenAPI generated server

Spring Boot Server 


## Overview  
This server was generated by the [OpenAPI Generator](https://openapi-generator.tech) project.
By using the [OpenAPI-Spec](https://openapis.org), you can easily generate a server stub.
This is an example of building a OpenAPI-enabled server in Java using the SpringBoot framework.

The underlying library integrating OpenAPI to SpringBoot is [springfox](https://github.com/springfox/springfox)

Start your server as a simple java application

You can view the api documentation in swagger-ui by pointing to  
http://localhost:8080/

Change default port value in application.properties -->

# WaCoDiS Data Access API

This projects implements a REST API that persists and manages all relevant data within the KomMonitor project.

**Table of Content**
<!-- TOC depthFrom:1 depthTo:6 withLinks:1 updateOnSave:0 orderedList:0 -->
Create a nice table of content, please.

<!-- /TOC -->

## WaCoDiS Project Information
General project information

### Architecture Overview

<p align="center">
  <img src="https://raw.githubusercontent.com/WaCoDiS/apis-and-workflows/master/architecture/wacodis_high_level_architecture.png" width="600" alt="Diagram of WaCoDiS high level architecture">
</p>

* Brief archictecture description

## Overview  
* Brief component description
* OpenAPI Specification
* Utilized technologies

## Installation / Building Information
* installation information (maven build, etc.)

### Configuration
Configuration is fetched from [WaCoDiS Config Server](https://github.com/WaCoDiS/config-server). If config server is not available configuration values located at *main/resources/bootstrap.yml* are applied instead.  
#### Parameters
The following section contain descriptions for configuration parameters ordered by configuration section.

##### spring/resources-api
parameters related to the Resource API (*/resources/...*)  

| value     | description       | note  |
| ------------- |-------------| -----|
| elasticsearch/uri     | elasticsearch server address | uri scheme must match *http://host:port* |
| elasticsearch/index      | name of the index (containing DataEnvelopes) that should be queried   |  |
| elasticsearch/requestTimeout_Millis  | request timeout (milliseconds) |  |

##### spring/dataenvelopes-api
parameters related to the DataEnvelope API (*/dataenvelopes/...*)  

| value     | description     | note  |
| ------------- |-------------| -----|
| elasticsearch/uri     | elasticsearch server address | uri scheme must match *http://host:port* |
| elasticsearch/index      | name of the index (containing DataEnvelopes) that should be queried   |  |
| elasticsearch/requestTimeout_Millis  | request timeout (milliseconds) |  |
| elasticsearch/indexInitialization_RetryMaxAttempts  | max attempts for index intitialization during start-up | [see Elasticsearch Index Initialization](#elasticsearch-index-initialization) |
| elasticsearch/indexInitialization_RetryDelay_Millis  | delay between atempts for index intitialization during start-up (milliseconds) |  |
| elasticsearch/indexInitialization_SettingsFile | location of settings file that is applied for index intitialization during start-up|  |

##### spring/cloud/stream/bindings/acknowledgeDataEnvelope
parameters related to DataEnvelope acknowledgement messages

| value     | description       | note  |
| ------------- |-------------| -----|
| destination     | topic used for DataEnvelope acknowledgement messages | e.g. *wacodis.dataenvelope.acknowledgment* |
| binder      | defines the binder (message broker)   | see [binders](#spring/cloud/stream/binders/wacodis_rabbit), does not have to be changed from *wacodis_rabbit* |
| content-type      | content type of  DataEnvelope acknowledgement messages (mime type)   | see [binders](#spring/cloud/stream/binders/wacodis_rabbit), does not have to be changed from *application/json* |

##### spring/cloud/stream/binders/wacodis_rabbit
parameters related to WaCoDis message broker

| value     | description       | note  |
| ------------- |-------------| -----|
| type     | type of message broker  | WaCoDiS uses [RabbitMQ message broker](https://www.rabbitmq.com/)|
| environment/spring/rabbitmq/host | RabbitMQ host (WaCoDiS message broker) | e.g. *localhost* |
| environment/spring/rabbitmq/host | RabbitMQ port (WaCoDiS message broker)   | e.g. *5672*|
| environment/spring/rabbitmq/username | RabbitMQ username (WaCoDiS message broker)   | |
| environment/spring/rabbitmq/password | RabbitMQ password (WaCoDiS message broker)   | |


### Deployment
This section describes deployment scenarios, options and preconditions.
#### Preconditions
* A instance of [elasticsearch](https://www.elastic.co/downloads/elasticsearch) must be available.  
* When running data access as part of the WaCoDiS system, a running instance of [RabbitMQ message broker](https://www.rabbitmq.com/) must be available. Otherwise communication with other WaCoDis components fails.  
  
The server addresses are [configurable](#configuration).  
  
 * If configuration should be fetched from Configuration Server a running instance of [WaCoDiS Config Server](https://github.com/WaCoDiS/config-server) must be available.
## User Guide
### Run Data Access
Data Access is a Spring Boot application. Run *org.openapitools.OpenAPI2SpringBoot.java* to start the application.
### Elasticsearch Index Initialization
During the start up process, data access automatically initializes a search index that indexes metadata (DataEnvelopes) for available data sets. The index settings are defined in a json file which is by default */main/resources/elasticsearch_indexsettings.json*. The mappings section of this file should not be altered because data access needs an index that matches those specifications. The location of the index settings file is [configurable](#configuration).  
If index intitialization fails because of a connection error it is retried after a timeout. The max. number of retries and the timeout is [configurable](#configuration). This configuration parameters can be used in deployment scenarios (for example docker compose) if elasticsearch is not available before data access is started.

## Contribution - Developer Information
This section contains information for developers.

### How to Contribute
#### Extending Data Access
##### New Types of DataEnvelope and SubsetDefinition
Data Access must be modified if new types of DataEnvelope or SubsetDefintion are added to [Wacodis schemas](https://github.com/WaCoDiS/apis-and-workflows/blob/master/openapi/src/main/definitions/wacodis-schemas.yml) in order to support the newly introduced data types. See the Wiki for further information.

### Branching
The master branch provides sources for stable builds. The develop branch represents the latest (maybe unstable) state of development.

### License and Third Party Lib POM Plugins
[optional]

## Contact
|    Name   |   Organization    |    Mail    |
| :-------------: |:-------------:| :-----:|
| Sebastian Drost | Bochum University of Applied Sciences | sebastian.drost@hs-bochum.de |
| Arne Vogt | Bochum University of Applied Sciences | arne.vogt@hs-bochum.de |
| Andreas Wytzisk  | Bochum University of Applied Sciences | andreas.wytzisk@hs-bochum.de |
| Matthes Rieke | 52째 North GmbH | m.rieke@52north.org |

## Credits and Contributing Organizations
- Department of Geodesy, Bochum University of Applied Sciences, Bochum
- 52째 North Initiative for Geospatial Open Source Software GmbH, M체nster
- Wupperverband, Wuppertal
- EFTAS Fernerkundung Technologietransfer GmbH, M체nster

The research project WaCoDiS is funded by the BMVI as part of the [mFund programme](https://www.bmvi.de/DE/Themen/Digitales/mFund/Ueberblick/ueberblick.html)  
<p align="center">
  <img src="https://wacodis.fbg-hsbo.de/wp-content/uploads/2018/04/mfund-logo.jpg" width="200">
  <img src="https://wacodis.fbg-hsbo.de/wp-content/uploads/2018/09/German-Federal-Ministry-of-Transport-and-Digital-Infrastructure.jpg" width="200">
</p>
